Refactoring based on Fowler's book